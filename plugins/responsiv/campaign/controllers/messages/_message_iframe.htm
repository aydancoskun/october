<?php
    $message = $formModel;
?>
<?php if ($message): ?>
    <div style="position:relative">
        <div style="position: absolute; top:0; left:0; bottom:0; right:0"></div>
        <iframe id="<?= $this->getId('messageIframe') ?>" style="width: 100%; height: 500px; padding: 0" frameborder="0"></iframe>
    </div>
    <script type="text/template" id="<?= $this->getId('messageContents') ?>">
        <?= $message->content_html ?: $message->renderTemplate() ?>
    </script>
    <script>
        (function($){
            var messageContents,
                messageFrame = $('#<?= $this->getId('messageIframe') ?>')

            $(document).render(function(){
                var frameContents = messageFrame.contents().find('html')
                messageContents = $('#<?= $this->getId('messageContents') ?>').html()
                frameContents.html(messageContents)
                messageFrame.height(frameContents.height())
            })
        })(window.jQuery);
    </script>

<?php else: ?>
    <p class="flash-message static error">Invoice template not found</p>
<?php endif ?>